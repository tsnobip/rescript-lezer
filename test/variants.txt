# Nominal variants

type color =
  | Red
  | Rgb(int, int, int)
  | Hex: string

==>

Script(TypeDeclaration(type,TypeBinding(TypeName,"=",TypeBody(VariantType("|",VariantConstructorCase(VariantConstructor(ConstructorName)),"|",VariantConstructorCase(VariantConstructorArgsToken,VariantConstructorArgs("(",TypeName,",",TypeName,",",TypeName,")")),"|",VariantConstructorCase(VariantConstructorResultToken,VariantConstructorResult(":",TypeName)))))))

# Polymorphic variants

type t = [
  | #Foo
  | #Bar(string, int)
  | #Baz(baz)
]

==>

Script(TypeDeclaration(type,TypeBinding(TypeName,"=",TypeBody(TypeAlias(PolyVariantType("[",PolyVariantCaseList("|",PolyVariantCase(PolyVariantTag(Hash,ConstructorName)),"|",PolyVariantCase(PolyVariantTag(Hash,ConstructorName),PolyVariantPayload("(",TypeName,",",TypeName,")")),"|",PolyVariantCase(PolyVariantTag(Hash,ConstructorName),PolyVariantPayload("(",TypeName,")"))),"]"))))))
